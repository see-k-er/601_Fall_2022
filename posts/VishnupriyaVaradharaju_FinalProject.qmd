---
title: "How has Terrorism Grown Over The Years ? - A Visual Study"
author: "Vishnupriya Varadharaju"
desription: "Final Project"
date: "12/22/2022"
format:
  html:
    toc: true
    code-copy: true
    code-tools: true
    smooth-scroll: true
    highlight-style: github
    df-print: paged

categories:
  - FinalProject
  - Global Terrorism Data
  
output: distill::distill_article

---

```{r setup, include=FALSE}

library(tidyverse)
library(ggplot2)
library(lubridate)
library(dplyr)
library("readxl")
library(summarytools)
library(mapdata)
library(maptools)
library(moments)
library(corrplot)
library(treemap)

knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, results='asis')
```

## DACSS 601: Data Science Fundamentals Final Paper

Global Terrorism Dataset

## Introduction

26/11 (26 Nov) is a very heartbreaking day to remember for a lot of Indians. It was the day when India had one of its deadliest terror attacks. It happened in 2008 and I still remember watching the news for hourly updates on the terror attack. Every year when I come across this day, I always have a lot of questions in my head. How have the trends of Terrorism been over the years? Why are certain cities targeted more than others? What kind of weapons do different extremist groups use? Which is the most deadliest extremist group? Is the extremism international or home-grown? and a lot more.

The topic for my final project was inspired by this and I decided to do this study on Global Terrorism to help answer my questions.
The Global Terrorism Database (GTD) contains more than 200,000 records of terrorist attacks that have taken place around the world from 1970 till 2022. This Database is maintained by the National Consortium for the Study of Terrorism and Responses to Terrorism (START) at the University of Maryland. The database has a codebook wherein detailed explanations for each of the categories are provided. The database has been used by popular news channels to showcase trends in Regional Terror activities. It has all the necessary elements that can help me answer various questions that I hope to find with this study.


## Data

### Reading The Dataset
The dataset is in the form of an excel file. It has nearly 209706 rows and 135 columns. Each row corresponds to a terror incident. The various fields include GTD ID, incident date, incident location, incident information, attack information, target/victim information, perpetrator information, perpetrator statistics, claims of responsibility, weapon information, casualty information, consequences, kidnapping/hostage taking information, additional and source information and many more.

These fields need to be analysed and only the important ones are chosen for the study.

```{r}
#reading in data set which is in excel format
gtd <- read_excel('_data/globalterrorismdb_0522dist.xlsx')
head(gtd, n=100)
```

### Describing The Data

On having an initial overview of the data, there seems to be a lot of columns with plenty of NA values. Given that there are 135 columns, it will be good to remove those columns that have minimal data and might not add enough value to the analysis.

This data has values that are a mix of different types ranging from numerical, character, logical and much more. There is some redundant data as well. Certain fields have categories that are encoded. But along with it the corresponding text variable is also given. For instance, *country* has codes for which *country_txt* has the corresponding text. Such fields can be removed to avoid redundancy.
Some fields like *summary*, *weapdetail* have entirely textual data which is not useful for statistical analysis and can be removed. 


```{r}
#str(gtd, list.len=15)
```

### Tidying Data

There are different aspects to look into while cleaning a data set. Null values can be removed, redundant values can be avoided, re-coding data categories and much more.

#### 1. Removing null values

Generally, it is good to have data which has less than 5% of NA values for analysis. Though there are a lot of fields that have more than 5% of NA values, I am dropping only those columns that have 100% null values. Data imputation cannot be performed for such columns as there is no existing data. 

```{r}
# To find those columns which have 100% null values
cols <- list()
for (col in names(gtd)) {
  nullVal <- (sum(is.na(gtd[,col]))/nrow(gtd))*100
  if (nullVal == 100){
    cols <- append(cols, col)
  }
}
print(paste("Number of columns with NA = 100% is", length(cols)))
gtd_select <- gtd %>% select(-(unlist(cols)))
```

After removing the null values there are 126 fields that are remaining.

#### 2. Data Summary, Imputation & Cleaning

The column *eventID* 12 digit event ID system where in the first 8 numbers correspond to the date in "yyyymmdd" format. The last 4 numbers are sequential case number for that given day of the format 0001, 0002, etc. This can be removed and new column *incDate* is created combining the *iyear*, *imonth* and *iday*. This field will be useful for creating time-series plot. 

Fields with encoded text categories are also removed. Few columns like *attacktype2*, *attacktype3* are an extension of the *attacktype1* column. These additional columns are included in case a particular incident can be classified under more than one attack type. Such additional columns are also removed as too much granularity is not needed for this study. The fields that have subcategoreies are also removed as it may not be required to answer my research questions.


```{r}
gtd_select <- gtd_select %>% mutate(
  incDate = ymd(str_c(iyear,imonth,iday, sep="/")),.before = iyear) %>%
  select(-c(eventid, approxdate,resolution,country,region,location,summary,specificity,attacktype1,targtype1,targsubtype1,
            natlty1,alternative,weaptype1,corp2,target2, natlty2,natlty2_txt,corp3,target3,natlty3,natlty3_txt,gsubname,
            gname2,motive,guncertain2,guncertain3,claimmode,claim2,claimmode2,claim3,claimmode3,compclaim,weapsubtype1,
            weapdetail,propextent,propcomment,addnotes,hostkidoutcome,related, contains("type3"), contains("type2"),
            contains("type4"),contains("scite"),contains("ty2"),contains("ty3")))
```

Using summarytools to get an overview of the data. The min, max, most frequently occurring categories, the percentage of null values, the data types and more information can be obtained from this.

```{r}
print(dfSummary(gtd_select))
```


From the above table we can see that the range of the data is from January 1970 to December 2020, spanning over 50 years. For the columns *imonth* and *iday*, there are entries of 0. This is done for those incidents where the date and month are not surely known. There are 891 values like that which can be retained for now and modified when needed for the visualizations.

```{r}
gtd_select %>% filter(imonth == 0 | iday ==0) %>% count()
```

We can see how the number of incidents has changed over time using a time series plot.

```{r}
incCount <- gtd_select %>% group_by(iyear) %>% summarise(incidents = n())
ggplot(incCount, aes(x=iyear, y=incidents, color="red")) + ggtitle("Global Terror Incidents 1970-2020") +labs(y="Incidents", x ="Year") + theme(axis.text.x=element_text(angle=60, hjust=1)) +
  geom_line() + geom_point() + theme(legend.position = "none")

```

The *extended* column tells if the duration of an incident is more than 24 hours (then 1) or if it's less than 24 hours (then 0).
The *country_txt* column shows the top countries where the most terror incidents have occurred. We can see that Iraq has the highest number of incidents, then comes Afghanistan, Pakistan, India and Columbia. A lot of middle east and Asian countries have the highest terror incidents.

On plotting *region_txt*, we can see the distribution of the incidents across 12 different regions. The countries that come under each of these regions can be referred from the GTD Codebook. The plot shows that Middle East & North Africa and South Asia have nearly same number of terror incidents and constitute for nearly 53% of global terror incidents.

```{r}
# top regions with most terror attacks over the years
regionCnt <- gtd_select %>% group_by(region_txt) %>% summarise(Incidents = n()) %>% arrange(desc(Incidents)) %>% head(n=10)

regionCnt %>% arrange(desc(Incidents)) %>%
  mutate(name=factor(region_txt, levels=Incidents))  %>%
  ggplot(aes(x=reorder(region_txt, +Incidents), y=Incidents)) +
    geom_segment(aes(xend=region_txt, yend=0)) +
    geom_point(size=4, color="red") +
    coord_flip() +
    theme_bw() + ggtitle("Region-Wise Terror Incidents 1970-2020") + labs(y="Incidents", x ="Regions")

```


Next, I want to see those cities in Western Europe (specifically) where highest number of terror incidents have occurred. Plotting the top 10 cities. There is an entry called unknown which can be ignored for this analysis.

```{r fig.height= 5, fig.width=8}
cities <- gtd_select %>% filter(region_txt == "North America" & city != "Unknown") %>% group_by(city, longitude, latitude) %>% summarise(count = n()) %>% arrange(desc(count)) %>% head(n=11)

usa <- map_data("usa")
canada <- map_data("worldHires", "Canada")
mexico <- map_data("worldHires", "Mexico")

NAmap <- ggplot() + geom_polygon(data = usa,
                                 aes(x=long, y = lat, group = group),
                                 fill = "white",
                                 color="black") +
    geom_polygon(data = canada, aes(x=long, y = lat, group = group),
                 fill = "white", color="black") +
    geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
                 fill = "white", color="black") +
    coord_fixed(xlim = c(-140, -55),  ylim = c(10, 85), ratio = 1.2)

NAmap + geom_point(data=cities, aes(x=longitude, y=latitude, color=city, label=city), size=3.0) + ggtitle("Cities with highest terror rate in North America 1970-2020") +
  theme(line = element_blank(),
        axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks = element_blank(),
          rect = element_blank()) + labs(x="", y="",color="City")
```


The next column *vicinity* has 1, if the incident happened in immediate vicinity of the city or has 0, if the incident happened in the city itself.
The fields *crit1*, *crit2* and *crit3* indicate the criteria under which the incident has occurred.
* Criterion 1: POLITICAL, ECONOMIC, RELIGIOUS, OR SOCIAL GOAL
* Criterion 2: INTENTION TO COERCE, INTIMIDATE OR PUBLICIZE TO LARGER AUDIENCE(S)
* Criterion 3: OUTSIDE INTERNATIONAL HUMANITARIAN LAW
There are incidents where there is an overlap of all three criterias. These can be filtered for further analysis later on.

*doubterr* is 1, if there is doubt as to whether the incident was an act of terrorism. Else it is 0. *alternative_txt* depends on this. If there is doubt as to whether the incident is was an act of terrorism, the incident is then classified under 5 other categories. From the table we can see that nearly 82% of the incidents that were doubtful about being a terror attack were an Insurgency or Guerilla Action. 

```{r}
gtd_select %>% filter(doubtterr==1) %>% group_by(alternative_txt) %>% summarise(count = n()) %>% mutate(
  percent = count/sum(count)*100
) %>% select(-c(count)) %>% rename(AlternativeAttack = alternative_txt, Percentage = percent) %>% arrange(desc(Percentage))
```


*multiple* corresponds to 1, if the incident was part of multiple attacks, else it is 0. The percentage of single incidents is much higher than multiple incidents.
*success* corresponds to 1, if the attack was successful, else it is 0. The attacks can be assassination, armed assault, bombing/explosion, hijacking, hostage taking(barricade or kidnapping), facility/infrastructure attack and unarmed assault. There have been nearly 88% of successful attacks compared to 12% of unsuccessful attacks.
*suicide* corresponds to 1, if it was a suicide attack where the perpetrator did not intend to escape from the attack alive, 0 otherwise. Only 3.5% of the attacks were suicide attacks. This can mean that the perpetrators intended to live to carry out future attacks.

*attacktype1_txt* has 9 subcategories of the type of terror attack. One of the field is unknown wherein the attack type could not be determined from the available information. We can see from the plot, that through all years, Bombing/Explosin has been the most common attack type.


```{r fig.width=10}
# bar plot
attck <- gtd_select %>% filter(attacktype1_txt != 'Unknown') %>% group_by(iyear, attacktype1_txt) %>% summarise(incidents = n())
ggplot(attck, aes(fill=attacktype1_txt, y=incidents, x=iyear)) +
    geom_bar(position="stack", stat="identity") + labs(x="Year", y="Incidents", title ="Terror Attack Types Over The Years", fill="Attack Type")
```


*targtype1_txt* corresponds to the general type of target/victim. There are 22 categories with the highest category being Private Citizens and Property. Next comes the Military, then the Police, then the Government and then Business. There is an Unknown category here as well. We can ignore *targsubtype1_txt* for now as it has nearly 112 different subcategories of the main target type and granularity is not required currently. *target1* is also too broad a category and highly specific. Hence, it is ignored for now.

*corp1* is the entity or government agency that was targeted. Here, nearly 20% of the data has null values. 12% of the data is marked as Unknown, if the entity targeted was unspecified. About 11% of the data is marked as Not Applicable as no specific entity was targeted. Here, for the null values, we can rename them as "No Information".

```{r}
gtd_select <- gtd_select %>% mutate_at(vars(corp1), list(~ replace_na(., "No Information")))
```

*natlty1_txt* is the nationality of the Target/Victim. Here, in most cases it is same as that of the country in which the incident took place, but for Hijacking incidents, it is the nationality of the plane and not the passengers. Plotting a graph to see the nationalities of the planes in Hijacking incidents. The most number of such incidents has happened in India followed by Colombia. We can also see a category called International, which might imply that the incident happened while flying over more than one country.

```{r}
ntlt <- gtd_select %>% filter(attacktype1_txt == 'Hijacking') %>% group_by(natlty1_txt) %>% summarise(incidents = n()) %>% arrange(desc(incidents)) %>% head(n=10)

ntlt %>% ggplot(aes(x=reorder(natlty1_txt, +incidents), y=incidents)) +
  geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4)+
    coord_flip() +
    theme_bw() + ggtitle("Flight Hijakcing Incidents 1970-2020") + labs(x="Country", y ="Incidents")
```

*gname* tells us about the extremist group that was responsible for the terror attack. For nearly 43% of the incidents, the group that is responsible is unknown. From the known groups, the highest is Taliban followed by ISIS, then Shining Path (SL) and then Al-Shabaab.

*guncertain1* corresponds to 1, if the information reported about the attack group is based on speculation or dubious claims of responsibility. It is 0, if the perpetrator for the incident is not suspected. This value is nearly 92.4% for 0.

*individual* is 1, if the perpetrator was not affliated to any known group and was by themselves. It was 0 otherwise. Only 0.4% of the incidents were caused by such individuals.

*nperps* gives numerical data about the number of perpetrators involved in each incident. There are discrepancies with this. As mentioned in the codebook, it's best to consider the data only after 1997 for accuracy. Similarly *nperpcap* corresponds to the number of perpetrators who were captured. For this also, it's best to consider the data after 1997.

After filtering the values for above 1997, we can see that the Null values for *nperps* and *nperpcap* has reduced to 9.3% and 2.4% respectively. These fields have -99 as the value when the number is not reported. Hence, this number cannot be taken in face value. 

```{r}
u <- gtd_select %>% filter(iyear > 1997) %>% select(nperps, nperpcap)
print(dfSummary(u))
```

On looking at the statistics, for both these fields, the mean value is negative and there are outliers which tend to make the data very skewed. Hence, we will impute the null values with the respective median values, -99 for *nperps* and 0 for *nperpcap*.

```{r}
gtd_select <- gtd_select %>% mutate_at(vars(nperps), list(~ replace_na(., median(nperps, na.rm=T)))) %>% mutate_at(vars(nperpcap), list(~ replace_na(., median(nperpcap, na.rm=T))))
```

*claimed* is a categorical variable, with the value 1, if a group/person has claimed responsibility for the attack. It is 0 otherwise. The value of -9 occurs, if the data is not available. As there are nearly 31% null values, we can also assign -9 to these as it is unknown. The codebook also states that the data is systematically available from 1997 only. On filtering values with year greater than 1997, we can see that the unknown values only account to about 1% of the filtered data. 

```{r}
gtd_select <- gtd_select %>% mutate_at(vars(claimed), list(~ replace_na(., -9)))
temp <- gtd_select %>% filter(iyear>1997) %>% select(claimed)
print(dfSummary(temp))
```


*claimmode_txt* records one of the 10 modes used by claimants to claim responsibility. This field is also systematically present after 1997. Here we can see that nearly 88% of the data has null values. Furthermore, there is one extra abnormal category as '0' which can be renamed to Unknown. These entries exist only for those fields where there was a claim made to the terror attack. The 0.1% of missing values in the filtered data was reassigned to the category of 'Unknown'.
The most popular modes of claiming attack are Personal Claims and Posting to Website or blog. The least common mode of claiming an attack were making a call prior to the incident and writing a letter.

```{r}
gtd_select <- gtd_select %>% mutate(claimmode_txt = replace(claimmode_txt, claimmode_txt == '0', 'Unknown'))
gtd_select$claimmode_txt[gtd_select$iyear > 1997 & gtd_select$claimed == 1 & is.na(gtd_select$claimmode_txt)] <- "Unknown"
temp <- gtd_select %>% filter(iyear>1997 & claimed==1) %>% group_by(claimmode_txt) %>% summarise(count = n())
 
treemap(temp,
            index="claimmode_txt",
            vSize="count",
            type="index",
            palette = "Set3",                        
            fontsize.title=12,
            border.lwds=c(1),
            title="Mode of Claiming Attack (1998 - 2020)",
            )
```


*weaptype1_txt* correspond to the different categories of weapons used. There are 13 different categories including Other (weapons that do not fit into the other categories) and Unknown (weapon type could not be determined). The most used weapon is explosives, followed by Firearms.

```{r fig.width = 5}

weap <- gtd_select %>% group_by(weaptype1_txt) %>% summarise(incidents = n()) %>%
  mutate(weaptype1_txt =
    case_when(
      weaptype1_txt == "Vehicle (not to include vehicle-borne explosives, i.e., car or truck bombs)" ~ "Vehicle",
      TRUE ~ as.character(weaptype1_txt)
    ), fraction = incidents/sum(incidents), ymax = cumsum(fraction), ymin = c(0,head(ymax, n=-1))
  )


# Make the plot
ggplot(weap, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=weaptype1_txt)) +
     geom_rect() +
     coord_polar(theta="y") + scale_fill_brewer(palette = "Paired") +
     xlim(c(2, 4)) + guides(fill = guide_legend(title = "Weapon Type")) +
  theme(panel.background = element_rect(fill = "white"),
        panel.grid = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text = element_blank()) + ggtitle("Weapons Used for Terror Incidents 1970-2020")

```

There are nearly 30+ *weapsubtype1_txt* as mentioned in the codebook.  The null values are replaced with the category 'Unknown' which corresponds to the weapon type being Unknown. This field is however not very important for this study.

```{r}
gtd_select <- gtd_select %>% mutate_at(vars(weapsubtype1_txt), list(~ replace_na(., "Unknown")))
```


*nkill* and *nwound* are numerical fields that correspond to the number of people killed and the number of people wounded respectively and includes both the victims and attackers as well . From these fields less than 10% of the data are Nulls. These null values can be imputed with their respective mean values. We can then combine these two into a single field to find the total number of casualties due to a terror incident. The mean casualties is near 5.5, the median is 1. The min is 0 and max is 12263. On plotting the histogram, it is seen that the plot is severely right skewed (highly positive skewness value).


```{r}

gtd_select <- gtd_select %>% mutate_at(vars(nkill), list(~ replace_na(., mean(nkill, na.rm=T)))) %>% mutate_at(vars(nwound), list(~ replace_na(., mean(nwound, na.rm=T))))

gtd_select <- gtd_select %>% mutate(
  ncasual = nkill+nwound, .before = nkill
)
cas <- gtd_select %>% filter(is.na(ncasual)==FALSE)

summary(cas$ncasual)
skewness(cas$ncasual)
ggplot(cas, aes(x=ncasual))+
  geom_histogram(color="darkblue", fill="lightblue") + ggtitle("Casualties Histogram") +
  labs(x="Casualties", y="Incidents Count")


```


*nkillus* corresponds to the number of US citizens killed in attacks and *nwoundus* is the number of US citizens wounded in the attacks. I am not focusing on these fields as this study focuses on global casualties. *nkillter* and *nwoundte* are the casualties with respect to the perpetrators. This field is also not focused in this study. *nkill* and *nwound* includes values from the above fields as well.

*property* is 1 (49.1%), if property was damaged, else it is 0 (37.5%). There is also another entry of '-9' (13.4%) which corresponds to those incidents for which there is not enough data. This can be ignored during visualization.

*propextent_txt* is the extent to which property damage has taken place. There are 4 sub categories based on the property value in dollars. These categories can be renamed for ease of reading. Furthermore, there is also an abnormal value of 7 which can be renamed to Unknown. Null values are also renamed to Unknown. Most of the known damages are under the Minor category. Major and Catastrophic property damages are very minimal.

```{r}
gtd_select <- gtd_select %>% mutate(propextent_txt = replace(propextent_txt, propextent_txt == '7', 'Unknown')) %>%
  mutate(propextent_txt =
    case_when(
      propextent_txt == "Minor (likely < $1 million)" ~ "Minor",
      propextent_txt == "Major (likely >= $1 million but < $1 billion)" ~ "Major",
      propextent_txt == "Catastrophic (likely >= $1 billion)" ~ "Catastrophic",
      TRUE ~ as.character(propextent_txt)
    ))
gtd_select$propextent_txt[gtd_select$property == 1 & is.na(gtd_select$propextent_txt)] <- "Unknown"

temp <- gtd_select %>% filter(property == 1) %>% group_by(propextent_txt) %>% summarise(count = n()) %>%
  mutate(percent = count/sum(count)*100) %>% select(-c(count)) %>%
  rename(PropertyDamageExtent = propextent_txt, Percentage = percent) %>% arrange(desc(Percentage))
temp
```

*propvalue* gives the numerical value of the value of the property that was damaged in dollars. Here, we filter those properties that were damaged and have the extent as Unknown. From this, we can see that the number of null values is about 22%. The values with -99 can further be filtered as these correspond to Unknown values. We can now see that the mean of the damaged property value is \$825,308 and the median is \$25,000. We can also see that the histogram is highly skewed to the right.

```{r}
temp <- gtd_select %>% filter(property == 1 & propextent_txt != 'Unknown' & propvalue != -99) %>% select(property, propextent_txt, propvalue)

summary(temp$propvalue)
skewness(temp$propvalue)
ggplot(temp, aes(x=propvalue))+
  geom_histogram(color="darkblue", fill="maroon") + ggtitle("Damaged Property Value Histogram") +
  labs(x="Damaged Property Value", y="Incidents Count")
```


*ishostkid* is 1 (8.0%), if the victim was taken hostage or kidnapped, else it is 0 (91.7%). The '-9' (0.3%) category corresponds to unknown entries which can be ignored during visualization.

*nhostkid* is the number of victims that were taken hostage during an incident. This includes kidnapping and hijacking incidents as well. Here, we filter hostage incidents and then look for null values. We can see that there are few null values, which can be replaced with the median value after filtering the entries with -99. This value is also severely skewed to the right. *nhostkidus* is the number of hostages who were US nationals. This is included in *nhostkid* and is not needed for this study.

```{r}
gtd_select$nhostkid[gtd_select$ishostkid == 1 & is.na(gtd_select$nhostkid)] <- 2
```

*nhours* and *ndays* are collected for attack types which are “Hostage Taking (Kidnapping),” “Hostage Taking (Barricade Incident),” or (successful) “Hijacking”. If an incident occurs for more than 24 hours then, *nhours* is zero and only *ndays* is noted. On excluding the unknown hours and days, we can find the mean and median hours and days for which victims are taken as hostage. The average number of hours for which a victim is taken hostage is nearly 21 hours and the median is 2 hours. Whereas, the average number of days for which a victim is taken hostage is about 48 days and the median is 5 days.


```{r}
hours <- gtd_select %>% filter(attacktype1_txt == 'Hostage Taking (Kidnapping)' | attacktype1_txt == 'Hostage Taking (Barricade Incident)' | (attacktype1_txt == 'Hijacking' & success == 1)) %>% filter(nhours != -99 & nhours != -9 & extended == 0 ) %>% select(nhours)
print(summary(hours))

days <- gtd_select %>% filter(attacktype1_txt == 'Hostage Taking (Kidnapping)' | attacktype1_txt == 'Hostage Taking (Barricade Incident)' | (attacktype1_txt == 'Hijacking' & success == 1)) %>% filter(ndays != -99 & ndays != -9 & extended == 1 ) %>% select(ndays)
print(summary(days))
```

*divert* and *kidhijcountry* corresponds to the country where the hijackers diverted the vehicle and the country in which the hijacking was resolved respectively. The entries exist for specifically for “Hostage Taking (Kidnapping)” or “Hijacking” attack types. Here we can see that there are close to 78% null values indicated that, of the specified Hijacking incidents nearly 78% of them ended up not being resolved in another country.


```{r}
country_hijack <- gtd_select %>% filter(attacktype1_txt == 'Hijacking' | attacktype1_txt == 'Hostage Taking (Kidnapping)') %>% select(kidhijcountry)
print((sum(is.na(country_hijack))/nrow(country_hijack))*100)
```

*ransom* has the value 1, if the incident involved a demand of monetary ransom. It is 0 otherwise. It has -9, if it is unknown if there was a monetary ransom. There are about 61.6% of null values, which indicate that there was no ransom applicable.

*ransomamt* is the ransom amount demanded in US Dollars. The entry exists only if *ransom* is equal to 1. -99 exists for unknown monetary figures. Here, we can see that the average ransom amount is \$3,642,077 and the median ransom amount is \$61,526. *ransomamtus* is the ransom amount demanded from US sources. This is not required for the study currently. 
*ransompaid* is the ransom amount paid in US Dollars. This field also has an entry of -99 if the monetary figure is unknown. Here, we can see that the average ransom amount paid is \$1,214,101 and the median ransom amount paid is \$323. *ransompaidus* is the ransom amount paid by US sources. This is also not required for the study currently.


```{r}
summary(gtd_select %>% filter(ransom == 1 & ransomamt != -99) %>% select(ransomamt))
summary(gtd_select %>% filter(ransom == 1 & ransompaid != -99) %>% select(ransompaid))
```

*hostkidoutcome_txt* is the field which tells the fate of the hostages and kidnapped victims. If the “Attack Type” is “Hostage Taking (Kidnapping)”, “Hostage Taking (Barricade Incident),” or a successful “Hijacking,” then this field applies. Nearly 17% of the filtered data have missing values. These can be replaced as Unknown. The distribution of the Hostage Kidnapping Outcomes are seen in the bar graph. 

```{r}

gtd_select$hostkidoutcome_txt[(gtd_select$attacktype1_txt == 'Hostage Taking (Kidnapping)' | gtd_select$attacktype1_txt == 'Hostage Taking (Barricade Incident)' | (gtd_select$attacktype1_txt == 'Hijacking' & gtd_select$success == 1)) & is.na(gtd_select$hostkidoutcome_txt)] <- "Unknown"

outcome <- gtd_select %>% filter(attacktype1_txt == 'Hostage Taking (Kidnapping)' | attacktype1_txt == 'Hostage Taking (Barricade Incident)' | (attacktype1_txt == 'Hijacking' & success == 1)) %>%  select(hostkidoutcome_txt) %>% group_by(hostkidoutcome_txt) %>% summarise(count = n()) %>% arrange(desc(count))

outcome %>% ggplot(aes(x=reorder(hostkidoutcome_txt, +count), y=count)) +
  geom_bar(stat="identity", fill="#a630a0", alpha=.9, width=.5)+
    coord_flip() +
     ggtitle("Distribution of Hostage Kidnapping Outcomes") + labs(x="Hostage Kidnapping Outcomes", y ="Incidents")
```


*nreleased* gives the number of hostages who survived “Hostage Taking (Kidnapping)” or “Hostage Taking (Barricade Incident)” or a successful “Hijacking” incident. The value of -99 is given to Unknown entries. From the filtered data, we can see that the average number of hostages who survive such an incident is 7 and the median value is 1.

```{r}
release <- gtd_select %>% filter(attacktype1_txt == 'Hostage Taking (Kidnapping)' | attacktype1_txt == 'Hostage Taking (Barricade Incident)' | (attacktype1_txt == 'Hijacking' & success == 1)) %>%  select(nreleased) %>% filter(nreleased != -99)
print(summary(release))
```


*dbsource* had details about the teams that took efforts to collect and consolidate all this data. Currently, it is being maintained and constantly updated by the START team at University of Maryland. But, there have been other groups that have helped with this data collection through the years. From the summarytable, we can see that nearly 50% of the data was collected by START and nearly 30% of the data was collected by PGIS. But I would like to know which team was responsible for the collection of the data through the years.
From the plot, we can see that during the early years, PGIS played a major role in collecting the data, then CETIS for a couple of years, followed by ISVG. Finally START took over to maintain the database entirely. Overlapping of these major teams is not seen from the plot. There are however, other smaller teams which have contributed occasionally to the database.


```{r fig.width=8}
#Grouping the data and choosing only the top 8 teams (START, PGIS, ISVG, CETIS, CAIN, UMD Schmid 2012, Hewitt Project, UMD Algeria 2010-2012) that have aided with the data collection process.

sources <- c('START', 'PGIS', 'ISVG', 'CETIS', 'CAIN', 'UMD Schmid 2012', 'Hewitt Project', 'UMD Algeria 2010-2012')
dbsrc <- gtd_select %>% filter(str_detect(dbsource, str_c(sources, collapse = "|")), is.na(incDate) == FALSE)

new <- dbsrc %>% mutate(
  yrmon = ym(str_c(iyear,imonth, sep="/"))) %>% select(c(yrmon,dbsource)) %>% group_by(yrmon, dbsource) %>%
  summarise(count= n())

ggplot(new, aes(x=yrmon, y=count, fill=dbsource)) +
    geom_area() + ggtitle("Database Collection from 1970 through 2020") +
  labs(x="Year", y="Incidents", fill="Source")

```

*INT_LOG*, *INT_IDEO*,*INT_MISC*, *INT_ANY* are representations of international attacks. If the value is 1, it implies that the nationality of the attack group/perpetrator is different from that of the victim/target. It is 0 otherwise. There is also '-9' for those incidents that do not have enough information. Here I am ignoring *INT_MISC* and combining the remaining three columns into a single column. Even if any one of the fields have 1, then it will be considered international. If all have '-9', then those rows are dropped for visualization.

On dropping the unknown values, we can see that International Terror incidents were nearly 37% and domestic events were nearly 63%. To explore further, I want to see how many terror attacks were domestic and how many were by international extremists in Western Europe Vs South Asia.

```{r}
gtd_select <- gtd_select %>% select(-c(INT_MISC)) %>%
  mutate(intNew =
    case_when(
      INT_ANY == -9 & INT_LOG == -9 & INT_IDEO == -9 ~ -9,
      INT_ANY == 1 | INT_LOG == 1 | INT_IDEO == 1 ~ 1,
      INT_ANY == 0 | INT_LOG == 0 | INT_IDEO == 0 ~ 0,
      TRUE ~ as.numeric(-9)
    )
  ) %>% select(-c(INT_ANY,INT_LOG,INT_IDEO))
```

```{r fig.width=10}
int <- gtd_select %>% filter(intNew!=-9) %>%  group_by(intNew, region_txt) %>%
  summarise(fatal = sum(ncasual, na.rm=TRUE)) %>%
  mutate(intNew =
    case_when(
      intNew == 1 ~ 'International',
      intNew == 0 ~ 'Domestic',
      TRUE ~ as.character("na")
    )
  )

ggplot(int, aes(y=fatal, x=intNew, fill=intNew)) +
    geom_bar(position="stack", stat="identity") + labs(x="", y="Incidents", title ="Domestic Vs International Terror Attacks across regions from 1970-2020", fill="Category" ) + facet_wrap(~region_txt)
```

From the above plot, we can see the variations between different regions. In South Asia, South America, Sub-Saharan Africa we see more domestic attacks than international. While in North America, Western Europe, Middle East & North Africa, we see more international attacks than domestic. More analysis can be done on the origin of the extreme groups and their targets. This can help us understand if there is a direct relation between the main location of the extremist group and the location of their target. It could explain the higher number of domestic threats in South Asia, which could be because of higher number of extremist groups from that region.


So far, I have included descriptive statistics of the data. I've retained all the necessary fields and values upon which I can perform further analysis to find answers to my research questions.


### Research Questions

1. How has terrorism spread throughout the world since 1970 until now? Are there some regions which have constantly faced terror attacks? Are there regions that had previously no terror attacks, but are suddenly under plenty of terror attacks?

2. Can correlations be drawn between different numerical fields of this dataset? This can help look at relations between certain factors in the dataset.

3. Do certain terror groups have certain ways of attacking? What kind of weapons do they use the most? 

4. Trends of the most popular terror groups throughout the years. It'll be good to visualize the rise and fall of different extremist groups over the years. This visualization can help us ponder into why a particular group thrived during certain periods.

5. What is the average number of people who are killed per terror attack? How does this change region-wise?


## Visualization

With the tidied dataset, I would like to answer the research questions that I had posed in the previous section.

### Viz 1
Firstly I am splitting the years into four sections - 1970-1984, 1984-1999, 2000-2009, 2010-2020. Plotting the world map for each incident separately along with the distribution of successful and unsuccessful attacks are also shown.

```{r fig.width = 8}
# create data for world coordinates using map_data() function
world <- map_data("world")

# converting the success from numerical into categorical data type

gtd_select <- within(gtd_select, {   
  success.cat <- NA # need to initialize variable
  success.cat[success == 0] <- "Unsuccessful"
  success.cat[success == 1] <- "Successful"
   } )

plot0 <- gtd_select %>% filter(iyear < 1985)
plot1 <- gtd_select %>% filter(iyear >= 1985 & iyear < 2000)
plot2 <- gtd_select %>% filter(iyear >= 2000 & iyear < 2010)
plot3 <- gtd_select %>% filter(iyear >= 2010)

ggplot() +
  geom_map(
    data = world, map = world,
    aes(long, lat, map_id = region),
    color = "white", fill = "lightgray", size = 0.1
  ) + geom_point(
    data = plot0,
    aes(longitude, latitude,
        color = success.cat),
    alpha = 0.5
  ) +
  theme_void() + labs(x = NULL, y = NULL, color = "Attack Status")+
  labs(title="Global Terror Attacks 1970-1984")

ggplot() +
  geom_map(
    data = world, map = world,
    aes(long, lat, map_id = region),
    color = "white", fill = "lightgray", size = 0.1
  ) + geom_point(
    data = plot1,
    aes(longitude, latitude,
        color = success.cat),
    alpha = 0.5
  ) +
  theme_void() + labs(x = NULL, y = NULL, color = "Attack Status")+
  labs(title="Global Terror Attacks 1984-1999")

ggplot() +
  geom_map(
    data = world, map = world,
    aes(long, lat, map_id = region),
    color = "white", fill = "lightgray", size = 0.1
  ) +
  geom_point(
    data = plot2,
    aes(longitude, latitude,
        color = success.cat),
    alpha = 0.5
  ) + labs(x = NULL, y = NULL, color = "Attack Status")+
  theme_void() +
  labs(title="Global Terror Attacks 2000-2009")

ggplot() +
  geom_map(
    data = world, map = world,
    aes(long, lat, map_id = region),
    color = "white", fill = "lightgray", size = 0.1
  ) +
  geom_point(
    data = plot3,
    aes(longitude, latitude,
        color = success.cat),
    alpha = 0.5
  ) +
  labs(x = NULL, y = NULL, color = "Attack Status")+
  theme_void() +
  labs(title="Global Terror Attacks 2010-2020")
```

There is stark difference between the four plots. We can very clearly see that there has been a rise in the incidents from 1984-1999 and then it has reduced from 2000-2009. Then again during 2010-2020, the incidents have risen globally. Over the years, there has been an increase in the number of incidents in mid African region. In South America, compared to 1984-1999, the incidents of terrorism is lower in 2010-2020. We can also see that the density of the incidents has risen by large proportions in regions of India, Afghanistan, Pakistan, Iran, Iraq and parts of Europe. These plots give a good idea about how terror activites have spread over the years. The difference could also be because of military coups or independence struggles in a lot of countries especially in South America and Africa which would've occurred during 1984-1999. The figure also shows that there have been far many successful terror attacks than unsuccessful ones.



### Viz 2
Drawing a correlation plot can help us determine those numerical variables that are related to other variables. I would like to know such factors which have strong correlation as it can help derive lots of conclusions. Some of the categorical variables like extended, multiple, success are all one-hot encoded and hence can be used as numerical data.

```{r}
corFeat <- gtd_select[,c("intNew","iyear","imonth","iday","extended","vicinity","multiple","success","suicide","guncertain1","individual","nkill", "nwound","nperps","nperpcap","nhostkid","propvalue","nhours","nreleased")]
corFeat <- na.omit(corFeat)
correlations <- cor(corFeat)
corrplot(correlations, method="circle", order = 'alphabet')
```

From this plot we can see that there is sporadic correlation between the numerical features of the cleaned data. Mainly *nwound* and *nkill* tend to show high positive correlation. This is probably because they both are the casualties and terror attack damages can cause death or injure civilians/people. There is also high positive correlation between *nreleased* and *nhostkid*. We can also see low correlation between number of perpetrators, suicide attacks and claimed attacks. There is strong positive correlation between the year and claimed attacks as well. There is also negative correlation between *nhours* and *iyear* and also between damaged property value and iyear. All other fields seem to have weak correlations.

### Viz 3

Here, I am selecting the top 6 deadly terror groups based on the highest number of casualties. Then on plotting the different attack types used by each group, we can see the most popular method of terror attack that a group follows. Furthermore, on including the weapon type as a sub group, we can see the respective weapons that are being used for carrying out the attacks.

```{r fig.width=10, fig.height=8}
trgrp <- gtd_select %>% select(iyear, incDate, gname, region_txt) %>% filter(gname != "Unknown") %>%
  group_by(gname) %>% summarise(incidents = n()) %>% arrange(desc(incidents)) %>% head(n=6) 
names <- c(trgrp$gname)
int <- gtd_select %>% select(attacktype1_txt, weaptype1_txt, gname) 
grpattack <- subset(int, gname %in% names) %>% group_by(gname, attacktype1_txt, weaptype1_txt) %>%
  summarise(incidents = n()) %>% 
  mutate(weaptype1_txt =
    case_when(
      weaptype1_txt == "Vehicle (not to include vehicle-borne explosives, i.e., car or truck bombs)" ~ "Vehicle",
      TRUE ~ as.character(weaptype1_txt)
    ))

ggplot(grpattack, aes(x=incidents, y=attacktype1_txt , fill=weaptype1_txt)) +
    geom_bar(position="stack", stat="identity") + labs(y="Attack Type", x="Incidents", title ="Attack Type Distribution for Top 6 Terror Groups 1970-2020", fill ="Weapon Type") + facet_wrap(~gname) 
```

From above, we can see that Taliban has the highest number of attacks with Bombing/Explosion and Armed Assault being nearly equal. There is also an Unknown type of attack that the Taliban follow which is used as much as Bombing/Explosion and Armed Assault. It is good to do research into what this Unknown type might be as it constitutes a major portion of the attack for the most deadliest group. Similarly for other groups like ISIL, Shining Path, we can see that Bombing/Explosion and Armed Assault are the most common attack types. For these attacks, Explosives and Firearms are the weapons that are used. For the Unknown attack type, weapons that are still Unknown are used. Out of the different weapon types, Chemical, Melee, Sabotage Equipment and Vehicles are almost not used or very minimally used. Unarmed Assault, Hostage Taking (Barricade Incident) and Hijacking are also the least popular attack types among these groups. 
This plot gives an overall idea of the most preferred attack types and weapon types that are used by the deadliest terror groups around the world.


### Viz 4

I wanted to see how the different extremist groups have lasted through different years. Was there any group that had a downfall? Was there any group that had a sudden uprising? Selecting a few groups only as there are 2000+ such extremist groups.

```{r fig.width = 10}
grp <- gtd_select %>% select(iyear, incDate, gname, region_txt) %>% filter(gname != "Unknown") %>% filter(gname == "Taliban" | gname == "Islamic State of Iraq and the Levant (ISIL)" | gname == "Al-Shabaab" | gname == "Boko Haram" | gname == "Shining Path (SL)" | gname == "New People's Army (NPA)" | gname == "Farabundo Marti National Liberation Front (FMLN)" | gname == "Houthi extremists (Ansar Allah)" | gname == "Irish Republican Army (IRA)" | gname == "Kurdistan Workers' Party (PKK)") %>% 
  group_by(iyear, gname) %>% summarise(incidents = n()) %>% arrange(desc(incidents))


ggplot(grp, aes(x=iyear, y=incidents, color=gname)) + ggtitle("Terror Group Wise Attacks 1970-2020") + labs(y="Incidents", x ="Year", color="Terror Groups") + theme(axis.text.x=element_text(angle=60, hjust=1)) +
  geom_line() + geom_point(size=0.6) 

```


From this plot, we can very clearly see that initially there were only about 2-4 groups that were deadly. But in 2020, there are nearly 8 of these deadly terror groups that exist and have carried out terror activities. The Taliban started off in the 2000s and has jumped quickly from 2010 to 2020 to be the most deadly terror group globally. Similarly the ISIL group is also relatively new, having started off in 2013 and peaking during 2016-2017 and has declined in 2020. Furthermore, between the periods of 1996 to 2005, it looks like these terror groups were nascent, waiting to carry out the terror activities over the next decade. This line graph gives an overview of how these different terror groups have grown and declined over the years.


### Viz 5
I wanted to find the average number of casualties (deaths + wounded) in a terror attack in each region. This can tell the degree of damage that can be expected if a terror attack occurs in a particular place. 

```{r}
avgCas <- gtd_select %>% select(ncasual, region_txt) %>% group_by(region_txt) %>% summarise(sumcas= sum(ncasual, na.rm=TRUE), incident= n()) %>% mutate(
  avgCasReg = sumcas/incident
) %>% arrange(desc(avgCasReg)) %>% select(region_txt, avgCasReg) %>% rename(Region = region_txt, AverageCasualtyPerAttack = avgCasReg)
avgCas
```

East Asia has the highest average number of casualties per attack. Next is North America. Though South Asia has the second highest number of terror attacks, the average casualty per attack is somewhat in the median of the values. South America has the least average number of casualties per attack. 


## Reflection

This project helped me understand the process of data visualization and analysis. How to convert raw data into information that can be easily conveyed and is useful? 
For this particular study, I had to make a couple of assumptions in order to simplify the dataset. The codebook had mentioned very nuanced details with respect to the attack type, the duration of the event, if multiple incidents were linked, is the incident idealogically or logistically international and much more. While performing the data analysis I made sure to read through the description and only use that information which will be useful for my work. 
Given that this dataset is pretty huge I found it hard to figure out how to clean the dataset and reduce the dimensions. Initially I wasn't sure if I had to drop certain null values, or if I should retain some categories or should I re code Unknown variables and much more. Nearly 80% of my time was spent in cleaning the data to arrive at what was needed for this study. 
There is so much more that can be done with this dataset. Getting into the granularity of each country and analysing the activities of each terror group can give a lot of insights into local terror groups. This dataset also had a lot of textual data in the form of summary and notes. NLP methods can be applied to these text based fields to group most commonly used words occurring with an event, etc. In my study, I have not imputed the data for a lot of fields, instead I dropped them. But some fields can be imputed based on previous activities. This can help maintain the features of the dataset. Currently, I had dropped more than 50% of the columns as there were plenty of null values.  

## Conclusion

This study has answered a lot of questions that had me pondering upon initially. Incidents of terror attacks have increased during the last 10 years when compared with the years before that. However, these terror incidents are not always constant in a particular region. There are groups that become nascent for sometime before rising up again. Correlation between certain features of the data could not be drawn successfully. But correlated features could be identified if the region or country is narrowed down. The Taliban is the deadliest terror group with the highest number of casualties. Their most common type of attack methods include Bombing & Explosions and Armed Assault. They also do have other types of attack methods which have not been identified currently and need to be explored. Though the number of incidents and casualties are higher in Middle East & North Africa and South Asian regions, the average number of casualties is highest in East Asia followed by North America. 
There is no limit to the inferences that can be made from analysing this dataset. It'll be good to know why certain terror groups rose and became frequent with their terror activity and why suddenly they declined. This can help us relate to other global scenarios that have occurred. 
Some terror activities may have had long term impact on victims. Some victims/targets may not have been killed during the incident, but they could've passed away sometime after the incident. Though it is hard to keep track of this, it'll help provide an accurate number for the number of casualties.
The dataset had extensive information that could answer all of my research questions. But it would be beneficial to get into the granularity of the dataset for intricate analysis.


## Bibliography

* [1] <https://www.start.umd.edu/gtd/>
* [2] <https://www.r-project.org>
* [3] <https://r4ds.had.co.nz/index.html>
* [4] <https://r-graph-gallery.com/218-basic-barplots-with-ggplot2.html#horiz>
* [5] <https://rforhr.com/arrange.html>
* [6] <https://ggplot2.tidyverse.org/index.html>
* [7] <https://www.kaggle.com/datasets/START-UMD/gtd?datasetId=504&sortBy=voteCount>
* [8] <https://www.huffingtonpost.co.uk/2015/11/28/islamic-state-terrorism-threat_n_8670458.html>
* [9] <https://rpubs.com/julianhatwell/gtd>
* [10] <https://www.datanovia.com/en/blog/how-to-create-a-map-using-ggplot2/>

